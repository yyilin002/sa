<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Classification analysis applied on different normalization and study design.
Perform the simulation study in Qin et al. (see reference)."><title>precision simulation with classification — precision.simulate.class • PRECISION.array</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="precision simulation with classification — precision.simulate.class"><meta property="og:description" content="Classification analysis applied on different normalization and study design.
Perform the simulation study in Qin et al. (see reference)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PRECISION.array</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/my-vignette.html">PRECISION.array Vignette</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>precision simulation with classification</h1>
      
      <div class="d-none name"><code>precision.simulate.class.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Classification analysis applied on different normalization and study design.
Perform the simulation study in Qin et al. (see reference).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S3 method for simulate.class</span>
<span class="fu">precision</span><span class="op">(</span>
  <span class="va">seed</span>,
  <span class="va">N</span>,
  <span class="va">biological.effect.tr</span>,
  <span class="va">biological.effect.te</span>,
  <span class="va">handling.effect.tr</span>,
  <span class="va">handling.effect.te</span>,
  <span class="va">group.id.tr</span>,
  <span class="va">group.id.te</span>,
  train.design.met <span class="op">=</span> <span class="st">"NONE"</span>,
  test.design.met <span class="op">=</span> <span class="st">"NONE"</span>,
  train.norm.met <span class="op">=</span> <span class="st">"NN"</span>,
  test.norm.met <span class="op">=</span> <span class="st">"NN"</span>,
  class.met <span class="op">=</span> <span class="st">"LASSO"</span>,
  train.batch.id <span class="op">=</span> <span class="cn">NULL</span>,
  test.batch.id <span class="op">=</span> <span class="cn">NULL</span>,
  icombat <span class="op">=</span> <span class="cn">FALSE</span>,
  isva <span class="op">=</span> <span class="cn">FALSE</span>,
  iruv <span class="op">=</span> <span class="cn">FALSE</span>,
  biological.effect.tr.ctrl <span class="op">=</span> <span class="cn">NULL</span>,
  handling.effect.tr.ctrl <span class="op">=</span> <span class="cn">NULL</span>,
  norm.funcs <span class="op">=</span> <span class="cn">NULL</span>,
  class.funcs <span class="op">=</span> <span class="cn">NULL</span>,
  pred.funcs <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>seed</dt>
<dd><p>an integer used to initialize a pseudorandom number generator.</p></dd>
<dt>N</dt>
<dd><p>number of simulation runs.</p></dd>
<dt>biological.effect.tr</dt>
<dd><p>the training set of the estimated biological effects. This dataset must have rows as probes and columns as samples.</p></dd>
<dt>biological.effect.te</dt>
<dd><p>the test set of the estimated biological effects. This dataset must have rows as probes and columns as samples.
It must have the same number of probes and the same probe names as the training set of the estimated biological effects.</p></dd>
<dt>handling.effect.tr</dt>
<dd><p>the training set of the estimated handling effects. This dataset must have rows as probes and columns as samples.
It must have the same dimensions and the same probe names as the training set of the estimated biological effects.</p></dd>
<dt>handling.effect.te</dt>
<dd><p>the test set of the estimated handling effects. This dataset must have rows as probes, columns as samples.
It must have the same dimensions and the same probe names as the training set of the estimated handling effects.</p></dd>
<dt>group.id.tr</dt>
<dd><p>a vector of sample-group labels for each sample of the training set of the estimated biological effects.
It must be a 2-level non-numeric factor vector.</p></dd>
<dt>group.id.te</dt>
<dd><p>a vector of sample-group labels for each sample of the test set of the estimated biological effects.
It must be a 2-level non-numeric factor vector.</p></dd>
<dt>train.design.met</dt>
<dd><p>a string for study design to be applied on the training set.
The built-in designs are "NONE", CC+", "CC-", "PC+", "PC-", "BLK", and "STR" for "No Rehybridization", "Complete Confounding 1",
"Complete Confounding 2", "Partial Confounding 1", "Partial Confounding 2", "Blocking", and "Stratification" in Qin et al.</p></dd>
<dt>test.design.met</dt>
<dd><p>a string for study design to be applied on the test set.
The built-in designs are "NONE", CC+", "CC-", "PC+", "PC-", "BLK", and "STR" for "No Rehybridization", "Complete Confounding 1",
"Complete Confounding 2", "Partial Confounding 1", "Partial Confounding 2", "Blocking", and "Stratification" in Qin et al.</p></dd>
<dt>train.norm.met</dt>
<dd><p>a string for normalization method to be applied on the training set.
The build-in available normalization methods are "NN", "QN", "MN", "VSN" for "No Normalization", "Quantile Normalization",
"Median Normalization", and "Variance Stabilizing Normalization".
User can provide a list of normalization methods given the functions are supplied (also see norm.funcs).</p></dd>
<dt>test.norm.met</dt>
<dd><p>a string for normalization method to be applied on the test set.
The build-in available normalization methods are "NN", "MN", "QN", "fMN", "fQN", "pMN", "pQN", "fVSN", for "No Normalization",
"Median Normalization", "Quantile Normalization", "Frozen Median Normalization", "Frozen Quantile Normalization",
"Pool Median Normalization", "Pool Quantile Normalization", "Frozen Vairance Stability Normalization".
User can provide a list of normalization methods given the functions are supplied (also see norm.funcs).</p></dd>
<dt>class.met</dt>
<dd><p>a string for classfication method to be fitted on the training set and predict on test set.
The build-in available classfication methods are "PAM", "LASSO", "ClaNC", "ranFor", "SVM", "kNN" and "DLDA",
for "Prediction Analysis for Microarrays", "Least Absolute Shrinkage and Selection Operator", "Classification to Nearest Centroids",
"Random Forest", "Support Vector Machine", "K-Nearest Neighbors" and "Diagonal Linear Discriminant".
User can provide a list of classification methods given the correponding model-building and
predicting functions are supplied (also see <code>class.funcs</code> and <code>pred.funcs</code>). You can also use your own classification method
by setting <code>class.met</code> as "custom". The format to create <code>custom.intcv</code> and <code>custom.predict</code> please refers to other
classification methods in this package.</p></dd>
<dt>icombat</dt>
<dd><p>an indicator for combat adjustment. By default, <code>icombat = FALSE</code> for no ComBat adjustment.</p></dd>
<dt>isva</dt>
<dd><p>an indicator for sva adjustment. By default, <code>isva = FALSE</code> for no sva adjustment.</p></dd>
<dt>iruv</dt>
<dd><p>an indicator for RUV-4 adjustment. By default, <code>iruv = FALSE</code> for no RUV-4 adjustment.</p></dd>
<dt>biological.effect.tr.ctrl</dt>
<dd><p>the training set of the negative-control probe biological effect data if <code>iruv = TRUE</code>.
This dataset must have rows as probes and columns as samples.
It also must have the same number of samples and the same sample names as <code>biological.effect.tr</code>.</p></dd>
<dt>handling.effect.tr.ctrl</dt>
<dd><p>the training set of the negative-control probe handling effect data if <code>iruv = TRUE</code>.
This dataset must have rows as probes and columns as samples.
It also must have the same dimensions and the same probe names as <code>biological.effect.tr.ctrl</code>.</p></dd>
<dt>norm.funcs</dt>
<dd><p>a list of strings for names of user-defined normalization method functions, in the order of <code>norm.list</code>,
excluding any built-in normalization methods.</p></dd>
<dt>class.funcs</dt>
<dd><p>a list of strings for names of user-defined classification model-building functions, in the order of <code>class.list</code>,
excluding any built-in classification methods.</p></dd>
<dt>pred.funcs</dt>
<dd><p>a list of strings for names of user-defined classification predicting functions, in the order of <code>class.list</code>,
excluding any built-in classification methods.</p></dd>
<dt>batch.id</dt>
<dd><p>a list of array indices grouped by batches when data were profiled.
The length of the list must be equal to the number of batches in the data;
the number of array indices must be the same as the number of samples.
This is required if stratification study design is specified in <code>design.list</code>; otherwise <code>batch.id = NULL</code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>simulation study results -- a list of array-to-sample assignments, fitted models,
and misclassification error rates across simulation runs:</p>
<dl><dt>assign_store</dt>
<dd><p>array-to-sample assignments for the study design, classified by "Train" and "Test"</p></dd>
<dt>model_store</dt>
<dd><p>models for the combination of study designs, normalization methods, and classification methods</p></dd>
<dt>error_store</dt>
<dd><p>internal and external misclassification error rates for the combination of study designs,
normalization methods, and classification methods, classfied by "Train" and "Test"</p></dd>
<dt>ari_store</dt>
<dd><p>adjusted rand index of the prediction on test data</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The classification anlaysis of simulation study consists of the following main steps:</p>
<p>First, The generation of training and test sets is the same as <code>precision.simultate</code>.
<code>precision.simulate.class</code> requires the training and test sets for both estimated biological effects and estimated handling effects.
The effects can be simulated as follows (using <code>estimate.biological.effect</code> and <code>estimate.handling.effect</code>).
The uniformly-handled dataset are used to approximate the biological effect for each sample,
and the difference between the two arrays (one from the uniformly-handled dataset and
the other from the nonuniformly-handled dataset, subtracting the former from the latter)
for the same sample are used to approximate the handling effect for each array in the nonuniformly-handled dataset.</p>
<p>The samples are randomly split into a training set and a test set, balanced by tumor type (in Qin et al., training-to-test ratio is 2:1).
The arrays were then non-randomly split to a training set and a test set (in Qin et al., training set n = 128 -- the first 64 and last 64 arrays
in the order of array processing; test set n = 64 -- the middle 64 arrays).
This setup allows different pairings of arrays and samples by various different training-and-test-set splits.
Furthermore, biological signal strength and confounding level of the handling effects can be modified
(using <code>reduce.signal</code> and <code>amplify.handling.effect</code>).</p>
<p>Second, apply "virtual re-hybridization" methods (using <code>rehybridize</code>) on the training and test sets.
There are 6 different methods to choose, besides doing no hybridization.
And it is also allowed to produce different methods on training set and test set.
This is specified in <code>train.design.met</code> and <code>test.design.met</code>.</p>
<p>Third, apply normalization on the training and test sets. There are three normalization methods to choose on the training set,
median normalization, quantile normalization and variance stabilizing normalization. With these three methods,
test set can be processed the same method, or corresponding frozen normalization and pool normalization.
Besides, both sets can choose to do no normalization. The normalization methods are specified in <code>train.norm.met</code>
and <code>test.norm.met</code>. Data preprocessing and batch effects can be adjusted specified with <code>icombat</code>, <code>isva</code> and <code>iruv</code>.</p>
<p>Fourth, choose a classfication method, specified with <code>class.met</code>. This will fit a classification on the training set,
with a 5-fold cross validation and predict on the test set. The internal and external validation misclassificaiton error estimation,
and the adjusted rand index on the test set will be both included in the output.</p>
<p>For a given split of samples to training set versus test set,
<code>N</code> datasets will be simulated and analyzed for each array-assignment scheme.
For user-defined normalization method or classification method, please refer to the vignette.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Qin LX, Huang HC, Begg CB. Cautionary note on cross validation in molecular classification. Journal of Clinical Oncology. 2016</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span class="r-in"><span class="va">biological.effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="estimate.biological.effect.html">estimate.biological.effect</a></span><span class="op">(</span>uhdata <span class="op">=</span> <span class="va">uhdata.pl</span><span class="op">)</span></span>
<span class="r-in"><span class="va">handling.effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="estimate.handling.effect.html">estimate.handling.effect</a></span><span class="op">(</span>uhdata <span class="op">=</span> <span class="va">uhdata.pl</span>,</span>
<span class="r-in">                             nuhdata <span class="op">=</span> <span class="va">nuhdata.pl</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ctrl.genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">uhdata.pl</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"NC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">uhdata.pl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">biological.effect.nc</span> <span class="op">&lt;-</span> <span class="va">biological.effect</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">biological.effect</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span></span>
<span class="r-in"><span class="va">handling.effect.nc</span> <span class="op">&lt;-</span> <span class="va">handling.effect</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">handling.effect</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">group.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># randomly split biological effect data into training and test set with</span></span>
<span class="r-in"><span class="co"># equal number of endometrial and ovarian samples</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">redhalf.biological.effect.nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reduce.signal.html">reduce.signal</a></span><span class="op">(</span>biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>, group.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,group.id.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"V"</span><span class="op">)</span>,reduce.multiplier <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">biological.effect.train.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"E"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>,</span>
<span class="r-in">                                          <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"V"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">biological.effect.test.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">biological.effect.train.ind</span><span class="op">]</span></span>
<span class="r-in"><span class="va">biological.effect.train.test.split</span> <span class="op">=</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"tr"</span> <span class="op">=</span> <span class="va">biological.effect.train.ind</span>,</span>
<span class="r-in">       <span class="st">"te"</span> <span class="op">=</span> <span class="va">biological.effect.test.ind</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># non-randomly split handling effect data into training and test set</span></span>
<span class="r-in"><span class="va">handling.effect.train.test.split</span> <span class="op">=</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"tr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, <span class="fl">129</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span>,</span>
<span class="r-in">       <span class="st">"te"</span> <span class="op">=</span> <span class="fl">65</span><span class="op">:</span><span class="fl">128</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">biological.effect.nc.tr</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span>, <span class="va">biological.effect.train.ind</span><span class="op">]</span></span>
<span class="r-in"><span class="va">biological.effect.nc.te</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span>, <span class="va">biological.effect.test.ind</span><span class="op">]</span></span>
<span class="r-in"><span class="va">handling.effect.nc.tr</span> <span class="op">&lt;-</span> <span class="va">handling.effect.nc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, <span class="fl">129</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">handling.effect.nc.te</span> <span class="op">&lt;-</span> <span class="va">handling.effect.nc</span><span class="op">[</span>, <span class="fl">65</span><span class="op">:</span><span class="fl">128</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Simulation</span></span>
<span class="r-in"><span class="va">precision.result</span> <span class="op">=</span> <span class="fu">precision.simulate.class</span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">0</span>, N <span class="op">=</span> <span class="fl">3</span>,</span>
<span class="r-in">                                            biological.effect.tr <span class="op">=</span> <span class="va">biological.effect.nc.tr</span>,</span>
<span class="r-in">                                            biological.effect.te <span class="op">=</span> <span class="va">biological.effect.nc.te</span>,</span>
<span class="r-in">                                            handling.effect.tr <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,</span>
<span class="r-in">                                            handling.effect.te <span class="op">=</span> <span class="va">handling.effect.nc.te</span>,</span>
<span class="r-in">                                            group.id.tr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.tr</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span class="r-in">                                            group.id.te <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.te</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span class="r-in">                                            train.design.met <span class="op">=</span> <span class="st">"BLK"</span>,</span>
<span class="r-in">                                            test.design.met <span class="op">=</span> <span class="st">"STR"</span>,</span>
<span class="r-in">                                            train.norm.met <span class="op">=</span> <span class="st">"MN"</span>,</span>
<span class="r-in">                                            test.norm.met <span class="op">=</span> <span class="st">"fMN"</span>,</span>
<span class="r-in">                                            class.met <span class="op">=</span> <span class="st">"LASSO"</span>,</span>
<span class="r-in">                                            train.batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">41</span><span class="op">:</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">129</span><span class="op">:</span><span class="fl">152</span><span class="op">)</span><span class="op">-</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">153</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span><span class="op">-</span><span class="fl">64</span><span class="op">)</span>,</span>
<span class="r-in">                                            test.batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">(</span><span class="fl">65</span><span class="op">:</span><span class="fl">80</span><span class="op">)</span><span class="op">-</span><span class="fl">64</span>,<span class="op">(</span><span class="fl">81</span><span class="op">:</span><span class="fl">114</span><span class="op">)</span><span class="op">-</span><span class="fl">64</span>,<span class="op">(</span><span class="fl">115</span><span class="op">:</span><span class="fl">128</span><span class="op">)</span><span class="op">-</span><span class="fl">64</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Huei-Chung Huang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

