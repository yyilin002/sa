<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PRECISION.array">
<title>PRECISION.array Vignette • PRECISION.array</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PRECISION.array Vignette">
<meta property="og:description" content="PRECISION.array">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PRECISION.array</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/my-vignette.html">PRECISION.array Vignette</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="my-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>PRECISION.array Vignette</h1>
                        <h4 data-toc-skip class="author">Huei-Chung Huang, Yilin Wu, Qihang Yang, Lixuan Qin</h4>
            
            <h4 data-toc-skip class="date">2022-05-12</h4>
      
      
      <div class="d-none name"><code>my-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>PRECISION.array</code> is a package that allows users to conduct a re-sampling-based simulation study for molecular classification, using a unique pair of Agilent microRNA array datasets <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Qin LX, Huang HC, Begg CB. Cautionary note on cross validation in molecular classification. Journal of Clinical Oncology. 2016, &lt;a href="http://ascopubs.org/doi/abs/10.1200/JCO.2016.68.1031" class="external-link uri"&gt;http://ascopubs.org/doi/abs/10.1200/JCO.2016.68.1031&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a><sup>, </sup><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Huang HC, Qin LX. PRECISION: an R package for assessing study design and data normalization for molecular classification studies using a unique pair of microarray datasets (2016). GitHub repository, &lt;a href="https://github.com/LXQin/PRECISION.array" class="external-link uri"&gt;https://github.com/LXQin/PRECISION.array&lt;/a&gt;.&lt;/p&gt;'><sup>2</sup></a>. This simulation study is to illustrate the intricate interplay between data generation, data preprocessing, and classification error estimation for molecular classification. It offers insights into the desired practice of study design and data analysis for molecular classification, so that research sources can be optimized to generate high-quality molecular data and develop reproducible classifiers.</p>
<p>This document familiarizes users with the data and the functions available in the package. It also allows users to explore further on the topic using additional normalization and classification methods.</p>
<p>When using <code>PRECISION.array</code>, please cite the following papers:</p>
<ul>
<li><p>Huang HC, Qin LX. PRECISION: an R package for assessing study design and data normalization for molecular classification studies using a unique pair of microarray datasets (2016). GitHub repository, <a href="https://github.com/LXQin/PRECISION.array" class="external-link uri">https://github.com/LXQin/PRECISION.array</a>.</p></li>
<li><p>Qin LX, Huang HC, Begg CB. Cautionary note on cross validation in molecular classification. Journal of Clinical Oncology. 2016, <a href="http://ascopubs.org/doi/abs/10.1200/JCO.2016.68.1031" class="external-link uri">http://ascopubs.org/doi/abs/10.1200/JCO.2016.68.1031</a>.</p></li>
</ul>
<!-- When use the datasets, please cite the following papers: --><!-- - Qin LX, Zhou Q, Bogomolniy F, Villafania L, Olvera N, Cavatore M, Satagopan JM, Begg CB, Levine DA. Blocking and randomization to improve molecular biomarker discovery. Clinical Cancer Research 2014, 20:3371-3378 [http://clincancerres.aacrjournals.org/content/20/13/3371.long](http://clincancerres.aacrjournals.org/content/20/13/3371.long) -->
</div>
<div class="section level2">
<h2 id="package-overview">Package Overview<a class="anchor" aria-label="anchor" href="#package-overview"></a>
</h2>
<p>The first step is to install <code>PRECISION.array</code> from <code>CRAN</code> by typing the following command in R console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://clincancerres.aacrjournals.org/content/20/13/3371.long" class="external-link">PRECISION.array</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"PRECISION.array"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://clincancerres.aacrjournals.org/content/20/13/3371.long" class="external-link">PRECISION.array</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-description">Data Description<a class="anchor" aria-label="anchor" href="#data-description"></a>
</h2>
<p>Two datasets was generated for the same set of 96 endometrial and 96 ovarian tumor samples using different experimental handling designs. The first dataset was handled by one technician in one run and its arrays were randomly assigned to tumor samples with blocking (by array slide, uniformly-handled data). The second dataset was handled by two technicians in multiple batches and its arrays were assigned in the order of sample collection (without blocking or randomization), to mimic typical practice (nonuniformly-handled data). More details on the data collection can be found in Qin et al.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Qin LX, Zhou Q, Bogomolniy F, Villafania L, Olvera N, Cavatore M, Satagopan JM, Begg CB, Levine DA. Blocking and randomization to improve molecular biomarker discovery. Clinical Cancer Research 2014, 20:3371-3378 &lt;a href="http://clincancerres.aacrjournals.org/content/20/13/3371.long" class="external-link"&gt;here&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a> The datasets are publicly available at <code>GEO</code> <a href="http://www.ncbi.nlm.nih.gov/geo/" class="external-link">here</a>.</p>
<p>To save time for package loading, this package includes two example datasets (probe level): uniformly-handled data <code>uhdata.pl</code> and nonuniformly-handled data <code>nuhdata.pl</code>, which are the 5% random subset of markers from the original data. Here is a glimpse of the datasets. The last character of the sample labels “E” or “V” indicates whether the sample is an endometrial or ovarian tumor. To load the data, simply use the commands below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"uhdata.pl"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nuhdata.pl"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Uniformly-handled Data</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">JB5972V</th>
<th align="right">JB4825V</th>
<th align="right">JB4858E</th>
<th align="right">GL4837E</th>
<th align="right">JB4851E</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">8.127912</td>
<td align="right">8.819649</td>
<td align="right">7.884045</td>
<td align="right">8.857942</td>
<td align="right">9.181432</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">8.535484</td>
<td align="right">8.161763</td>
<td align="right">7.883385</td>
<td align="right">8.096256</td>
<td align="right">8.261834</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">8.634458</td>
<td align="right">8.314022</td>
<td align="right">7.971074</td>
<td align="right">8.233367</td>
<td align="right">8.389910</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">8.545949</td>
<td align="right">7.702258</td>
<td align="right">7.866278</td>
<td align="right">8.515314</td>
<td align="right">8.487699</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">8.424779</td>
<td align="right">8.231437</td>
<td align="right">7.898494</td>
<td align="right">8.288903</td>
<td align="right">8.401359</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">8.105393</td>
<td align="right">8.478708</td>
<td align="right">7.993641</td>
<td align="right">8.221049</td>
<td align="right">8.000047</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">7.976953</td>
<td align="right">8.214458</td>
<td align="right">7.393731</td>
<td align="right">8.261739</td>
<td align="right">8.555910</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">8.836939</td>
<td align="right">8.202411</td>
<td align="right">8.036554</td>
<td align="right">7.569069</td>
<td align="right">8.751100</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">8.611705</td>
<td align="right">8.004201</td>
<td align="right">7.807648</td>
<td align="right">8.449999</td>
<td align="right">8.298721</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">8.504557</td>
<td align="right">8.147085</td>
<td align="right">8.280617</td>
<td align="right">7.963467</td>
<td align="right">8.529588</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00010683</td>
<td align="right">9.081838</td>
<td align="right">8.514278</td>
<td align="right">10.076731</td>
<td align="right">10.375966</td>
<td align="right">10.904337</td>
</tr>
<tr class="even">
<td align="left">A_25_P00010683</td>
<td align="right">9.529377</td>
<td align="right">8.159895</td>
<td align="right">9.795241</td>
<td align="right">9.789566</td>
<td align="right">10.716169</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00010683</td>
<td align="right">9.461567</td>
<td align="right">8.558404</td>
<td align="right">10.080335</td>
<td align="right">10.221571</td>
<td align="right">10.624501</td>
</tr>
<tr class="even">
<td align="left">A_25_P00010683</td>
<td align="right">8.992816</td>
<td align="right">8.457382</td>
<td align="right">9.579407</td>
<td align="right">9.780759</td>
<td align="right">9.887891</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00010683</td>
<td align="right">9.006044</td>
<td align="right">7.941779</td>
<td align="right">10.307273</td>
<td align="right">9.639772</td>
<td align="right">11.094315</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Nonuniformly-handled Data</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">JB5535E</th>
<th align="right">JB5742E</th>
<th align="right">JB4662E</th>
<th align="right">JB4166E</th>
<th align="right">JB5669E</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">6.880656</td>
<td align="right">6.294369</td>
<td align="right">6.295855</td>
<td align="right">6.538598</td>
<td align="right">7.475843</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">6.870565</td>
<td align="right">6.285340</td>
<td align="right">5.991106</td>
<td align="right">6.977209</td>
<td align="right">6.618176</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">6.459899</td>
<td align="right">6.493501</td>
<td align="right">6.330137</td>
<td align="right">7.267487</td>
<td align="right">6.690687</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">6.534816</td>
<td align="right">6.025836</td>
<td align="right">6.240593</td>
<td align="right">5.980021</td>
<td align="right">6.713191</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">6.947713</td>
<td align="right">5.794147</td>
<td align="right">6.239196</td>
<td align="right">6.200107</td>
<td align="right">6.888207</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">7.077473</td>
<td align="right">6.385904</td>
<td align="right">6.883548</td>
<td align="right">6.015611</td>
<td align="right">6.832903</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">6.505584</td>
<td align="right">6.109736</td>
<td align="right">6.562414</td>
<td align="right">6.791078</td>
<td align="right">6.276491</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">7.088928</td>
<td align="right">6.146192</td>
<td align="right">6.500106</td>
<td align="right">6.107168</td>
<td align="right">7.146271</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00011991</td>
<td align="right">6.517463</td>
<td align="right">6.426560</td>
<td align="right">6.170426</td>
<td align="right">6.105437</td>
<td align="right">6.666085</td>
</tr>
<tr class="even">
<td align="left">A_25_P00011991</td>
<td align="right">6.369591</td>
<td align="right">6.498757</td>
<td align="right">6.956111</td>
<td align="right">6.670084</td>
<td align="right">6.514549</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00010683</td>
<td align="right">7.330250</td>
<td align="right">8.687832</td>
<td align="right">7.756061</td>
<td align="right">9.227016</td>
<td align="right">8.417432</td>
</tr>
<tr class="even">
<td align="left">A_25_P00010683</td>
<td align="right">7.246119</td>
<td align="right">8.634174</td>
<td align="right">7.405330</td>
<td align="right">9.212861</td>
<td align="right">8.638573</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00010683</td>
<td align="right">6.834843</td>
<td align="right">8.600903</td>
<td align="right">7.629651</td>
<td align="right">8.749649</td>
<td align="right">8.418061</td>
</tr>
<tr class="even">
<td align="left">A_25_P00010683</td>
<td align="right">7.472080</td>
<td align="right">8.618319</td>
<td align="right">7.278838</td>
<td align="right">9.303259</td>
<td align="right">8.976631</td>
</tr>
<tr class="odd">
<td align="left">A_25_P00010683</td>
<td align="right">7.495010</td>
<td align="right">8.514229</td>
<td align="right">7.338435</td>
<td align="right">9.255771</td>
<td align="right">8.995639</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="probe-selection">Probe Selection<a class="anchor" aria-label="anchor" href="#probe-selection"></a>
</h2>
<p>Initially, the number of replicates for each marker/probe varies between 10 and 40. We recommend truncating the number of replicates to a fixed number across probes to save data preprocessing time. We are confident in recommending this practice because we have previously observed that the variation among replicates for the same probe is small. Here, we provide <code><a href="../reference/per.unipbset.truncate.html">per.unipbset.truncate()</a></code> to truncate the number of replicates in data. In our simulation study, we used only the first 10 replicates for each unique probe.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Example of taking only the first 5 replicates for each unique probe</span>
<span class="va">uhdata.pl.p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/per.unipbset.truncate.html">per.unipbset.truncate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">uhdata.pl</span>,
                                      num.per.unipbset <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>The Agilent platform includes control probes, but most of the analyses demonstrated in this document will use only <strong>non-control probe</strong> data. An exception is when batch effects are adjusted by RUV-4 (explained in a later section). The following code identifies and <strong>filters</strong> out the control probes from the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># negative control probes</span>
<span class="va">ctrl.genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">uhdata.pl</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"NC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">uhdata.pl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>

<span class="va">uhdata.pl.nc</span> <span class="op">&lt;-</span> <span class="va">uhdata.pl</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">uhdata.pl</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span> <span class="co"># nc for non-control probes</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-simulation">Data Simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h2>
<p>We used the uniformly-handled dataset to approximate the biological effect for each sample, and the difference between the two arrays (one from the uniformly-handled dataset and the other from the nonuniformly-handled dataset) for the same sample to approximate the handling effect for each array in the nonuniformly-handled dataset. This is done with <code><a href="../reference/estimate.biological.effect.html">estimate.biological.effect()</a></code> and <code><a href="../reference/estimate.handling.effect.html">estimate.handling.effect()</a></code> as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">biological.effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.biological.effect.html">estimate.biological.effect</a></span><span class="op">(</span>uhdata <span class="op">=</span> <span class="va">uhdata.pl</span><span class="op">)</span>

<span class="va">handling.effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate.handling.effect.html">estimate.handling.effect</a></span><span class="op">(</span>uhdata <span class="op">=</span> <span class="va">uhdata.pl</span>, nuhdata <span class="op">=</span> <span class="va">nuhdata.pl</span><span class="op">)</span>

<span class="va">biological.effect.nc</span> <span class="op">&lt;-</span> <span class="va">biological.effect</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">biological.effect</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span>
<span class="va">handling.effect.nc</span> <span class="op">&lt;-</span> <span class="va">handling.effect</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">handling.effect</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span></code></pre></div>
<p>The 192 samples were <strong>randomly split</strong> in a 2:1 ratio into a training set and a test set, balanced by tumor type. The 192 arrays were <strong>non-randomly</strong> split to a training set (n=128, the first 64 and last 64 arrays in the order of array processing). The first 80 arrays were profiled by one technician and the rest by the other technician.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>
<span class="va">group.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>

<span class="co"># randomly split biological effect data into training and test set with equal number of endometrial and ovarian samples</span>
<span class="va">biological.effect.train.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"E"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"V"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> 
<span class="va">biological.effect.test.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">biological.effect.train.ind</span><span class="op">]</span>

<span class="co"># non-randomly split handling effect data into training and test set</span>
<span class="va">handling.effect.train.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">handling.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, <span class="fl">129</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span><span class="op">]</span>
<span class="va">handling.effect.test.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">handling.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="fl">65</span><span class="op">:</span><span class="fl">128</span><span class="op">]</span>

<span class="va">group.id.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"all"</span> <span class="op">=</span> <span class="va">group.id</span>,
                 <span class="st">"tr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">biological.effect.train.ind</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                 <span class="st">"te"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">biological.effect.test.ind</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>
<span class="va">array.to.sample.assign</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"all"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"V"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>,
                                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"E"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">32</span><span class="op">)</span><span class="op">)</span>,
                          <span class="st">"tr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"V"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>,
                          <span class="st">"te"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"E"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">32</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Next, for the training set, data were simulated through “virtual re-hybridization” by first assigning arrays to sample groups using a confounding design or a balanced design, and then summing the biological effect for a sample and the handling effect for its assigned array. For the test set, we used only the biological effect data from the uniformly-handled dataset. Three study design functions assign arrays to samples (<code><a href="../reference/confounding.design.html">confounding.design()</a></code>, <code><a href="../reference/stratification.design.html">stratification.design()</a></code>, <code><a href="../reference/blocking.design.html">blocking.design()</a></code>). Finally, <code><a href="../reference/rehybridize.html">rehybridize()</a></code> is provided to sum biological effects to handling effects, following array-to-sample assignments.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># complete confounding</span>
<span class="va">cc.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confounding.design.html">confounding.design</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, num.array <span class="op">=</span> <span class="fl">128</span>, 
                               degree <span class="op">=</span> <span class="st">"complete"</span>, rev.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># partial confounding reversed</span>
<span class="va">pc.rev.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confounding.design.html">confounding.design</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">2</span>, num.array <span class="op">=</span> <span class="fl">128</span>, 
                               degree <span class="op">=</span> <span class="st">"partial"</span>, rev.order <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># stratification</span>
<span class="va">batch.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">41</span><span class="op">:</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">129</span><span class="op">:</span><span class="fl">160</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span>, <span class="op">(</span><span class="fl">161</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span><span class="op">)</span>
<span class="va">str.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stratification.design.html">stratification.design</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">3</span>, num.array <span class="op">=</span> <span class="fl">128</span>,
                                       batch.id <span class="op">=</span> <span class="va">batch.id</span><span class="op">)</span>

<span class="co"># blocking</span>
<span class="va">blk.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blocking.design.html">blocking.design</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">4</span>, num.array <span class="op">=</span> <span class="fl">128</span><span class="op">)</span></code></pre></div>
<p>Below is one of the possible array-to-sample-group splits for the study designs. Each vertical bar represents an array and the color of each stripe represents which sample group the array is assigned to.</p>
<p><img src="my-vignette_files/figure-html/study.design.fig-1.png" width="576"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assign.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confounding.design.html">confounding.design</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, num.array <span class="op">=</span> <span class="fl">192</span>, 
                               degree <span class="op">=</span> <span class="st">"complete"</span>, rev.order <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">group.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>

<span class="co"># re-hybridize</span>
<span class="va">sim.data.raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rehybridize.html">rehybridize</a></span><span class="op">(</span>biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>,
                            handling.effect <span class="op">=</span> <span class="va">handling.effect.nc</span>,
                            group.id <span class="op">=</span> <span class="va">group.id</span>,
                            array.to.sample.assign <span class="op">=</span> <span class="va">assign.ind</span><span class="op">)</span>

<span class="co"># re-hybridize + correct batch effects with SVA</span>
<span class="va">sim.data.sva</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rehybridize.html">rehybridize</a></span><span class="op">(</span>biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>,
                            handling.effect <span class="op">=</span> <span class="va">handling.effect.nc</span>,
                            group.id <span class="op">=</span> <span class="va">group.id</span>,
                            array.to.sample.assign <span class="op">=</span> <span class="va">assign.ind</span>, 
                            isva <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># re-hybridize + correct batch effects with RUV-4</span>
<span class="va">biological.effect.ctrl</span> <span class="op">&lt;-</span> <span class="va">biological.effect</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">biological.effect</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span>
<span class="va">handling.effect.ctrl</span> <span class="op">&lt;-</span> <span class="va">handling.effect</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">handling.effect</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span>

<span class="va">sim.data.ruv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rehybridize.html">rehybridize</a></span><span class="op">(</span>biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>,
                            handling.effect <span class="op">=</span> <span class="va">handling.effect.nc</span>,
                            group.id <span class="op">=</span> <span class="va">group.id</span>,
                            array.to.sample.assign <span class="op">=</span> <span class="va">assign.ind</span>, 
                            iruv <span class="op">=</span> <span class="cn">TRUE</span>,
                            biological.effect.ctrl <span class="op">=</span> <span class="va">biological.effect.ctrl</span>,
                            handling.effect.ctrl <span class="op">=</span> <span class="va">handling.effect.ctrl</span><span class="op">)</span></code></pre></div>
<p>Batch effect correction is available in the re-hybridization step. The adjustment can be turned on by specifying <code>icombat = TRUE</code>, <code>isva = TRUE</code> or <code>iruv = TRUE</code> for ComBat<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Leek JT, Johnson WE, Parker HS, Fertig EJ, Jaffe AE and Storey JD (2016). Surrogate Variable Analysis. R package version 3.20.0.&lt;/p&gt;"><sup>4</sup></a>, sva<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Leek JT, Johnson WE, Parker HS, Fertig EJ, Jaffe AE and Storey JD (2016). Surrogate Variable Analysis. R package version 3.20.0.&lt;/p&gt;"><sup>5</sup></a>, and RUV-4<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;RUV: Johann Gagnon-Bartsch (2015). Detect and Remove Unwanted Variation using Negative Controls. R package version 0.9.6.&lt;/p&gt;"><sup>6</sup></a>; if none of these is selected, no batch adjustment will be performed. Note that when RUV-4 (<code>iruv = TRUE</code>) is selected, control-probe data must be supplied.</p>
</div>
<div class="section level2">
<h2 id="data-preprocessing">Data Preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h2>
<p>Data preprocessing in the study includes three steps:</p>
<ol style="list-style-type: decimal">
<li><p>log2 transformation;</p></li>
<li><p>normalization for training data and frozen normalization for test data (that is, mapping the empirical distribution of each individual test-set sample to the “frozen” empirical distribution of the normalized training data);</p></li>
<li><p>probe-replicate summarization using the median.</p></li>
</ol>
<p>We provide <code><a href="../reference/med.norm.html">med.norm()</a></code>, <code><a href="../reference/quant.norm.html">quant.norm()</a></code>, and <code><a href="../reference/vs.norm.html">vs.norm()</a></code> for median normalization, quantile normalization<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Bolstad BM, Irizarry RA, Astrand M, Speed TP: A comparison of normalization methods for high density oligonucleotide array data based on variance and bias. Bioinformatics 2003, 19(2):185-193. Bolstad BM: preprocessCore: A collection of pre-processing functions. R package version 1.34.0. 2016.&lt;/p&gt;"><sup>7</sup></a>, and variance stabilizing normalization<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Huber W, von Heydebreck A, Sultmann H, Poustka A, Vingron M: Variance stabilization applied to microarray data calibration and to the quantification of differential expression. Bioinformatics 2002, 18 Suppl 1(suppl 1):S96-104.&lt;/p&gt;"><sup>8</sup></a>, respectively. <!-- When parameter `test` is not supplied, the functions only normalize on training data and return `NULL` on the frozen normalized test.  --> <!-- Note: as the number of probes increases, VSN becomes more computationally intensive. --></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>
<span class="va">group.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim.data.raw</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>

<span class="co"># randomly split data into training and test set with equal number of endometrial and ovarian samples</span>
<span class="va">train.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"E"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"V"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>

<span class="va">train.dat</span> <span class="op">&lt;-</span> <span class="va">sim.data.raw</span><span class="op">[</span>, <span class="va">train.ind</span><span class="op">]</span>
<span class="va">test.dat</span> <span class="op">&lt;-</span> <span class="va">sim.data.raw</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim.data.raw</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">train.ind</span><span class="op">]</span>


<span class="co"># median normalize (normalize training data only)</span>
<span class="va">data.mn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/med.norm.html">med.norm</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">train.dat</span><span class="op">)</span>

<span class="co"># median normalize (frozen normalize test data only)</span>
<span class="va">data.mn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/med.norm.html">med.norm</a></span><span class="op">(</span>test <span class="op">=</span> <span class="va">test.dat</span>, ref.dis <span class="op">=</span> <span class="va">data.mn1</span><span class="op">$</span><span class="va">ref.dis</span><span class="op">)</span>

<span class="co"># quantile normalize (normalize training data + frozen normalize test data)</span>
<span class="va">data.qn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quant.norm.html">quant.norm</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">train.dat</span>, test <span class="op">=</span> <span class="va">test.dat</span><span class="op">)</span>

<span class="co"># variance stabilizing normalize (normalize training data + frozen normalize test data)</span>
<span class="va">data.vsn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vs.norm.html">vs.norm</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">train.dat</span>, test <span class="op">=</span> <span class="va">test.dat</span><span class="op">)</span></code></pre></div>
<p>To summarize replicate level data to unique probe level, based on within-probe medians, <code><a href="../reference/med.sum.pbset.html">med.sum.pbset()</a></code> can be used:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uhdata.psl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/med.sum.pbset.html">med.sum.pbset</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">uhdata.pl</span>, num.per.unipbset <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="classifier-development-and-error-estimation">Classifier Development and Error Estimation<a class="anchor" aria-label="anchor" href="#classifier-development-and-error-estimation"></a>
</h2>
<p>Regardless of classification methods, internal cross-validation can be used to select the tuning parameter(s) and external validation should be used to validate the performance. In our simulation study, we reported results from the use of two classification methods: one non-parametric method (prediction analysis for microarrays (PAM)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Tibshirani R, Hastie T, Narasimhan B, Chu G: Diagnosis of multiple cancer types by shrunken centroids of gene expression. Proceedings of the National Academy of Sciences of the United States of America 2002, 99(10):6567-6572. Hastie T, Tibshirani R., Narasimhan B, Chu G: pamr: Pam: prediction analysis for microarrays; 2014.&lt;/p&gt;"><sup>9</sup></a>) and one parametric method (THE least absolute shrinkage and selection operator (LASSO)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Tibshirani R: Regression shrinkage and selection via the Lasso. J Roy Stat Soc B Met 1996, 58(1):267-288. Friedman J, Hastie T, Tibshirani R: Regularization Paths for Generalized Linear Models via Coordinate Descent. J Stat Softw 2010, 33(1):1-22.&lt;/p&gt;"><sup>10</sup></a>). Examples of model-building and predicting functions in <code>PRECISION.array</code> are <code><a href="../reference/pam.intcv.html">pam.intcv()</a></code> and <code><a href="../reference/pam.predict.html">pam.predict()</a></code> for PAM and <code><a href="../reference/lasso.intcv.html">lasso.intcv()</a></code> and <code><a href="../reference/lasso.predict.html">lasso.predict()</a></code> for LASSO.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>
<span class="co"># randomly split biological effect data into training and test set with equal number of endometrial and ovarian samples</span>
<span class="va">biological.effect.train.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"E"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"V"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> 
<span class="va">biological.effect.test.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">biological.effect.train.ind</span><span class="op">]</span>

<span class="va">biological.effect.nc.tr</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span>, <span class="va">biological.effect.train.ind</span><span class="op">]</span>
<span class="va">biological.effect.nc.te</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span>, <span class="va">biological.effect.test.ind</span><span class="op">]</span>

<span class="co"># build a PAM classifier</span>
<span class="va">pam.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pam.intcv.html">pam.intcv</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">biological.effect.nc.tr</span>,
                     y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.tr</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                     kfold <span class="op">=</span> <span class="fl">5</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># predict with the PAM classifier</span>
<span class="va">pam.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pam.predict.html">pam.predict</a></span><span class="op">(</span>pam.intcv.model <span class="op">=</span> <span class="va">pam.int</span>, 
                        pred.obj <span class="op">=</span> <span class="va">biological.effect.nc.te</span>, 
                        pred.obj.group.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.te</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>

<span class="co"># cross-validation misclassification error rate</span>
<span class="va">pam.int</span><span class="op">$</span><span class="va">mc</span>
<span class="co"># external validation misclassification error rate</span>
<span class="va">pam.pred</span><span class="op">$</span><span class="va">mc</span>

<span class="co"># build a LASSO classifier</span>
<span class="va">lasso.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lasso.intcv.html">lasso.intcv</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">biological.effect.nc.tr</span>,
                     y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.tr</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                     kfold <span class="op">=</span> <span class="fl">5</span>, seed <span class="op">=</span> <span class="fl">1</span>, alp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># predict with the LASSO classifier</span>
<span class="va">lasso.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lasso.predict.html">lasso.predict</a></span><span class="op">(</span>lasso.intcv.model <span class="op">=</span> <span class="va">lasso.int</span>, 
                        pred.obj <span class="op">=</span> <span class="va">biological.effect.nc.te</span>, 
                        pred.obj.group.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.te</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span>

<span class="co"># cross-validation misclassification error rate</span>
<span class="va">lasso.int</span><span class="op">$</span><span class="va">mc</span>
<span class="co"># external validation misclassification error rate</span>
<span class="va">lasso.pred</span><span class="op">$</span><span class="va">mc</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wrapper-functions-for-running-simulations">Wrapper Functions for Running Simulations<a class="anchor" aria-label="anchor" href="#wrapper-functions-for-running-simulations"></a>
</h2>
<p>Finally, the main functionality of <code>PRECISION.array</code> is to provide users with an efficient way to reproduce our simulation studies reported in JCO in press. Two wrapper functions are available to do so: one for the analysis of the uniformly-handled data and the other for the analysis of data with confounding handling (i.e. the analysis of simulated data)</p>
<div class="section level3">
<h3 id="analysis-of-the-uniformly-handled-data">Analysis of the uniformly-handled data<a class="anchor" aria-label="anchor" href="#analysis-of-the-uniformly-handled-data"></a>
</h3>
<p>The analysis of the uniformly-handled data is based on <code>N</code> splits of training-and-test-set for the uniformly-handled data; <code><a href="../reference/uni.handled.simulate.html">uni.handled.simulate()</a></code> is used. Users can manipulate the signal level of the estimated biological effects and choose the method for data normalization and classification.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uni.handled.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uni.handled.simulate.html">uni.handled.simulate</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, N <span class="op">=</span> <span class="fl">3</span>,
                                            biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>,
                                            norm.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NN"</span>, <span class="st">"QN"</span><span class="op">)</span>,
                                            class.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAM"</span>, <span class="st">"LASSO"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">uni.handled.results</span><span class="op">$</span><span class="va">error_store</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span>, 
             caption <span class="op">=</span> <span class="st">"Analysis of uniformly-handled data"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Analysis of uniformly-handled data</caption>
<thead><tr class="header">
<th align="right">PAM.NN</th>
<th align="right">PAM.QN</th>
<th align="right">LASSO.NN</th>
<th align="right">LASSO.QN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.171875</td>
<td align="right">0.140625</td>
<td align="right">0.187500</td>
<td align="right">0.156250</td>
</tr>
<tr class="even">
<td align="right">0.140625</td>
<td align="right">0.156250</td>
<td align="right">0.156250</td>
<td align="right">0.156250</td>
</tr>
<tr class="odd">
<td align="right">0.156250</td>
<td align="right">0.156250</td>
<td align="right">0.140625</td>
<td align="right">0.171875</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="analysis-with-confounding-handling">Analysis with confounding handling<a class="anchor" aria-label="anchor" href="#analysis-with-confounding-handling"></a>
</h3>
<p>The analysis of data with confounding handling is based on <code>N</code> array-to-sample reassignments using <code><a href="../reference/precision.simulate.html">precision.simulate()</a></code>. Users can control the signal level of the estimated biological effects, the confounding level of the estimated handling effects, array-to-sample study design, the normalization method, the batch adjustment method, and the classification methods.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>
<span class="va">group.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>

<span class="co"># randomly split biological effect data into training and test set with equal number of endometrial and ovarian samples</span>
<span class="va">biological.effect.train.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"E"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group.id</span> <span class="op">==</span> <span class="st">"V"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">64</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> 
<span class="va">biological.effect.test.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">biological.effect.train.ind</span><span class="op">]</span>

<span class="va">biological.effect.train.test.split</span> <span class="op">=</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"tr"</span> <span class="op">=</span> <span class="va">biological.effect.train.ind</span>,
       <span class="st">"te"</span> <span class="op">=</span> <span class="va">biological.effect.test.ind</span><span class="op">)</span>

<span class="co"># non-randomly split handling effect data into training and test set; technician effect as proxy</span>
<span class="va">handling.effect.train.test.split</span> <span class="op">=</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"tr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, <span class="fl">129</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span>,
       <span class="st">"te"</span> <span class="op">=</span> <span class="fl">65</span><span class="op">:</span><span class="fl">128</span><span class="op">)</span>

<span class="va">biological.effect.nc.tr</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span>, <span class="va">biological.effect.train.ind</span><span class="op">]</span>
<span class="va">biological.effect.nc.te</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span>, <span class="va">biological.effect.test.ind</span><span class="op">]</span>
<span class="va">handling.effect.nc.tr</span> <span class="op">&lt;-</span> <span class="va">handling.effect.nc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, <span class="fl">129</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span><span class="op">]</span>
<span class="va">handling.effect.nc.te</span> <span class="op">&lt;-</span> <span class="va">handling.effect.nc</span><span class="op">[</span>, <span class="fl">65</span><span class="op">:</span><span class="fl">128</span><span class="op">]</span>

<span class="co"># simulation without batch adjustment</span>
<span class="va">precision.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/precision.simulate.html">precision.simulate</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, N <span class="op">=</span> <span class="fl">3</span>,
                          biological.effect.tr <span class="op">=</span> <span class="va">biological.effect.nc.tr</span>,    
                          biological.effect.te <span class="op">=</span> <span class="va">biological.effect.nc.te</span>,
                          handling.effect.tr <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
                          handling.effect.te <span class="op">=</span> <span class="va">handling.effect.nc.te</span>,
                          group.id.tr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.tr</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                          group.id.te <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.te</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                          design.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC-"</span>, <span class="st">"STR"</span><span class="op">)</span>,
                          norm.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NN"</span>, <span class="st">"QN"</span><span class="op">)</span>,
                          class.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAM"</span>, <span class="st">"LASSO"</span><span class="op">)</span>,
                          batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">41</span><span class="op">:</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">129</span><span class="op">:</span><span class="fl">160</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span>, <span class="op">(</span><span class="fl">161</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span><span class="op">)</span><span class="op">)</span>

<span class="co"># simulation with RUV-4 batch adjustment</span>
<span class="co">#   (bringing in control-probe data)</span>
<span class="va">biological.effect.tr.ctrl</span> <span class="op">&lt;-</span> <span class="va">biological.effect.ctrl</span><span class="op">[</span>, <span class="va">biological.effect.train.test.split</span><span class="op">$</span><span class="va">tr</span><span class="op">]</span>
<span class="va">handling.effect.tr.ctrl</span> <span class="op">&lt;-</span> <span class="va">handling.effect.ctrl</span><span class="op">[</span>, <span class="va">handling.effect.train.test.split</span><span class="op">$</span><span class="va">tr</span><span class="op">]</span>

<span class="va">precision.ruv4.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/precision.simulate.html">precision.simulate</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, N <span class="op">=</span> <span class="fl">3</span>,
                              biological.effect.tr <span class="op">=</span> <span class="va">biological.effect.nc.tr</span>,    
                              biological.effect.te <span class="op">=</span> <span class="va">biological.effect.nc.te</span>,
                              handling.effect.tr <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
                              handling.effect.te <span class="op">=</span> <span class="va">handling.effect.nc.te</span>,
                              group.id.tr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.tr</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                              group.id.te <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.te</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                              design.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PC-"</span>, <span class="st">"STR"</span><span class="op">)</span>,
                              norm.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NN"</span>, <span class="st">"QN"</span><span class="op">)</span>,
                              class.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAM"</span>, <span class="st">"LASSO"</span><span class="op">)</span>,
                              batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">41</span><span class="op">:</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">129</span><span class="op">:</span><span class="fl">160</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span>, <span class="op">(</span><span class="fl">161</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span><span class="op">)</span>, 
                              iruv <span class="op">=</span> <span class="cn">TRUE</span>,
                              biological.effect.tr.ctrl <span class="op">=</span> <span class="va">biological.effect.tr.ctrl</span>, 
                              handling.effect.tr.ctrl <span class="op">=</span> <span class="va">handling.effect.tr.ctrl</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">precision.results</span><span class="op">$</span><span class="va">error_store</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"PC-"</span><span class="op">]</span><span class="op">)</span>, 
             aligh <span class="op">=</span> <span class="st">"l"</span>,
             caption <span class="op">=</span> <span class="st">"Analysis of simulated data in presence of confounding handling"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Analysis of simulated data in presence of confounding handling</caption>
<thead><tr class="header">
<th align="right">PAM.NN</th>
<th align="right">PAM.QN</th>
<th align="right">LASSO.NN</th>
<th align="right">LASSO.QN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.109375</td>
<td align="right">0.093750</td>
<td align="right">0.078125</td>
<td align="right">0.12500</td>
</tr>
<tr class="even">
<td align="right">0.078125</td>
<td align="right">0.078125</td>
<td align="right">0.078125</td>
<td align="right">0.09375</td>
</tr>
<tr class="odd">
<td align="right">0.125000</td>
<td align="right">0.093750</td>
<td align="right">0.093750</td>
<td align="right">0.06250</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">precision.ruv4.results</span><span class="op">$</span><span class="va">error_store</span><span class="op">[</span><span class="fl">2</span>, <span class="st">"PC-"</span><span class="op">]</span><span class="op">)</span>, 
             aligh <span class="op">=</span> <span class="st">"l"</span>,
             caption <span class="op">=</span> <span class="st">"Analysis of simulated data in presence of confounding handling, adjusting batch effects with RUV-4"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Analysis of simulated data in presence of confounding handling, adjusting batch effects with RUV-4</caption>
<thead><tr class="header">
<th align="right">PAM.NN</th>
<th align="right">PAM.QN</th>
<th align="right">LASSO.NN</th>
<th align="right">LASSO.QN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.250000</td>
<td align="right">0.171875</td>
<td align="right">0.359375</td>
<td align="right">0.328125</td>
</tr>
<tr class="even">
<td align="right">0.062500</td>
<td align="right">0.093750</td>
<td align="right">0.296875</td>
<td align="right">0.218750</td>
</tr>
<tr class="odd">
<td align="right">0.296875</td>
<td align="right">0.218750</td>
<td align="right">0.296875</td>
<td align="right">0.140625</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="additional-simulation-scenarios">Additional Simulation Scenarios<a class="anchor" aria-label="anchor" href="#additional-simulation-scenarios"></a>
</h2>
<p>Both <code><a href="../reference/uni.handled.simulate.html">uni.handled.simulate()</a></code> and <code><a href="../reference/precision.simulate.html">precision.simulate()</a></code> allows user-defined function for normalization or classification method comparison purposes.</p>
<p>A user-defined normalization method function must allow at least these two input parameters: <code>train</code> and <code>test</code> (<code>test</code> can be <code>NULL</code>). The user is required to provide a short name for the normalization method and use the short name (in lower case) when defining the output. For example, if the short name is “RN”, the function must return a list of two outputs: <code>train.rn</code> and <code>test.frn</code> for both normalized training and frozen-normalized test.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># an example of user-defined normalization method function:</span>

<span class="co"># rand.norm() randomly shuffles the sample IDs</span>
<span class="st">"rand.norm"</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">test.frn</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span>
    <span class="va">train.rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">train</span>, <span class="fl">2</span>, <span class="va">sample</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">train.rn</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>
    
    <span class="va">test.frn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">test</span>, <span class="fl">2</span>, <span class="va">sample</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">test.frn</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"train.rn"</span> <span class="op">=</span> <span class="va">train.rn</span>,
              <span class="st">"test.frn"</span> <span class="op">=</span> <span class="va">test.frn</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">uni.handled.results.rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uni.handled.simulate.html">uni.handled.simulate</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, N <span class="op">=</span> <span class="fl">3</span>,
                                       biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>,
                                       norm.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NN"</span>, <span class="st">"QN"</span>, <span class="st">"RN"</span><span class="op">)</span>,
                                       class.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAM"</span>, <span class="st">"LASSO"</span><span class="op">)</span>, 
                                       norm.funcs <span class="op">=</span> <span class="st">"rand.norm"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">uni.handled.results.rn</span><span class="op">$</span><span class="va">error_store</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span>, 
             caption <span class="op">=</span> <span class="st">"Analysis of uniformly-handled data (with RN)"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Analysis of uniformly-handled data (with RN)</caption>
<thead><tr class="header">
<th align="right">PAM.NN</th>
<th align="right">PAM.QN</th>
<th align="right">PAM.RN</th>
<th align="right">LASSO.NN</th>
<th align="right">LASSO.QN</th>
<th align="right">LASSO.RN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.156250</td>
<td align="right">0.12500</td>
<td align="right">0.468750</td>
<td align="right">0.171875</td>
<td align="right">0.156250</td>
<td align="right">0.50000</td>
</tr>
<tr class="even">
<td align="right">0.140625</td>
<td align="right">0.15625</td>
<td align="right">0.546875</td>
<td align="right">0.156250</td>
<td align="right">0.156250</td>
<td align="right">0.46875</td>
</tr>
<tr class="odd">
<td align="right">0.156250</td>
<td align="right">0.15625</td>
<td align="right">0.437500</td>
<td align="right">0.140625</td>
<td align="right">0.171875</td>
<td align="right">0.46875</td>
</tr>
</tbody>
</table>
<p>For each user-defined classification method, the user must provide two functions: one for building a model and one for predicting. The build function must allow input parameters <code>kfold</code>, <code>X</code>, <code>y</code>, <code>seed</code>, and must return a list of outputs at minimum including <code>mc</code>, <code>model</code> (naming must match). The predict function must allow three input parameters for the build model, object to be predicted, and group ID of the object to be predicted (note: order matters). Lastly, the predict function must return a list of outputs at minimum including <code>mc</code> for misclassification error rate (naming must match). It is not required but is highly recommended to return predicted probabilities and selected features for future uses.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># example of user-defined classification method functions:</span>
<span class="st">"build.ridge"</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kfold</span> <span class="op">=</span> <span class="fl">5</span>, <span class="va">X</span>, <span class="va">y</span>, <span class="va">seed</span>, <span class="va">alp</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span>
  <span class="va">ptm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span>
  
  <span class="va">cv.fit</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,
                              family <span class="op">=</span> <span class="st">"binomial"</span>, type.measure <span class="op">=</span> <span class="st">"class"</span>, 
                              alpha <span class="op">=</span> <span class="va">alp</span>, nfold <span class="op">=</span> <span class="va">kfold</span><span class="op">)</span>
  
  <span class="va">mc</span> <span class="op">&lt;-</span> <span class="va">cv.fit</span><span class="op">$</span><span class="va">cvm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">cv.fit</span><span class="op">$</span><span class="va">lambda</span> <span class="op">==</span> <span class="va">cv.fit</span><span class="op">$</span><span class="va">lambda.1se</span><span class="op">)</span><span class="op">]</span>
  
  <span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cv.fit</span>, s <span class="op">=</span> <span class="st">"lambda.1se"</span><span class="op">)</span>
  <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">ptm</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mc<span class="op">=</span><span class="va">mc</span>, time<span class="op">=</span><span class="va">time</span>, model<span class="op">=</span><span class="va">cv.fit</span>, cfs<span class="op">=</span><span class="va">coefs</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># ridge has the same prediction function as LASSO</span>

<span class="va">uni.handled.results.ridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uni.handled.simulate.html">uni.handled.simulate</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">1</span>, N <span class="op">=</span> <span class="fl">3</span>,
                                   biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>,
                                   norm.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NN"</span>, <span class="st">"RN"</span><span class="op">)</span>,
                                   class.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LASSO"</span>, <span class="st">"Ridge"</span><span class="op">)</span>, 
                                   norm.funcs <span class="op">=</span> <span class="st">"rand.norm"</span>,
                                   class.funcs <span class="op">=</span> <span class="st">"build.ridge"</span>, 
                                   pred.funcs <span class="op">=</span> <span class="st">"lasso.predict"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">uni.handled.results.ridge</span><span class="op">$</span><span class="va">error_store</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span>, 
             caption <span class="op">=</span> <span class="st">"Analysis of uniformly-handled data (with Ridge)"</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Analysis of uniformly-handled data (with Ridge)</caption>
<thead><tr class="header">
<th align="right">LASSO.NN</th>
<th align="right">LASSO.RN</th>
<th align="right">Ridge.NN</th>
<th align="right">Ridge.RN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.171875</td>
<td align="right">0.50000</td>
<td align="right">0.140625</td>
<td align="right">0.53125</td>
</tr>
<tr class="even">
<td align="right">0.156250</td>
<td align="right">0.46875</td>
<td align="right">0.125000</td>
<td align="right">0.56250</td>
</tr>
<tr class="odd">
<td align="right">0.140625</td>
<td align="right">0.46875</td>
<td align="right">0.125000</td>
<td align="right">0.46875</td>
</tr>
</tbody>
</table>
<p>Below is another example to create a SVM classification with specific parameters.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span>

<span class="st">"custom.intcv"</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kfold</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">X</span>, <span class="va">y</span>, <span class="va">seed</span><span class="op">)</span><span class="op">{</span>
  <span class="va">ptm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span>

  <span class="va">svm_tune</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html" class="external-link">tune.svm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, cost <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, tunecontrol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.control.html" class="external-link">tune.control</a></span><span class="op">(</span>cross <span class="op">=</span> <span class="va">kfold</span><span class="op">)</span><span class="op">)</span>

  <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">ptm</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mc <span class="op">=</span> <span class="va">svm_tune</span><span class="op">$</span><span class="va">best.performance</span>, time <span class="op">=</span> <span class="va">time</span>, model <span class="op">=</span> <span class="va">svm_tune</span><span class="op">$</span><span class="va">best.model</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="st">"custom.predict"</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">custom.intcv.model</span>, <span class="va">pred.obj</span>, <span class="va">pred.obj.group.id</span><span class="op">)</span><span class="op">{</span>

  <span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">custom.intcv.model</span><span class="op">$</span><span class="va">model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">pred.obj</span><span class="op">)</span><span class="op">)</span>
  <span class="va">mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tabulate.ext.err.func.html">tabulate.ext.err.func</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">pred.obj.group.id</span><span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pred<span class="op">=</span><span class="va">pred</span>, mc<span class="op">=</span><span class="va">mc</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulation-result-manipulation-and-visualization">Simulation Result Manipulation and Visualization<a class="anchor" aria-label="anchor" href="#simulation-result-manipulation-and-visualization"></a>
</h2>
<p><code>PRECISION.array</code> output <code>R</code> objects resulted from <code><a href="../reference/precision.simulate.html">precision.simulate()</a></code> can be tidied into a list of data frames by <code><a href="../reference/extract.precision.error.html">extract.precision.error()</a></code>. The list of data frames is easier to manipulate. A plotting function <code><a href="../reference/plot.precision.html">plot.precision()</a></code> is offered to have a quick visualization on the simulation results.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># for outputs from either precision.simulate() or precision.simulate.flex()</span>
<span class="va">precision.err.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract.precision.error.html">extract.precision.error</a></span><span class="op">(</span>
  precision.obj.name <span class="op">=</span> <span class="st">"precision.results"</span><span class="op">)</span>

<span class="co"># for PRECISION output from precision.simulate()</span>
<span class="fu"><a href="../reference/plot.precision.html">plot.precision</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">precision.err.df</span>, iflex <span class="op">=</span> <span class="cn">FALSE</span>, 
               mytitle <span class="op">=</span> <span class="st">"PRECISION results (misclassification error rate)"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/precision.vis-1.png" width="768"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># for PRECISION output from precision.simulate.flex()</span>
<span class="fu"><a href="../reference/plot.precision.html">plot.precision</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">precision.results.flex</span><span class="op">)</span></code></pre></div>
<div class="section level4">
<h4 id="differential-expression-analysis">Differential expression analysis<a class="anchor" aria-label="anchor" href="#differential-expression-analysis"></a>
</h4>
<p>We provide <code>limma.pbset</code> to perform differential expression analysis. For instance, when reducing a biological signal, we first identified differentially expressed markers and then shrunk the sample group differences of each of the markers.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uhdata.psl.nc</span> <span class="op">&lt;-</span> <span class="va">uhdata.psl</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">uhdata.psl</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ctrl.genes</span>, <span class="op">]</span> <span class="co"># nc for non-control probes</span>

<span class="va">group.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">uhdata.psl.nc</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>
<span class="va">group.id.level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">group.id</span><span class="op">)</span><span class="op">)</span>
<span class="va">limma.fit.uhdata</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/limma.pbset.html">limma.pbset</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">uhdata.psl.nc</span>, 
                               group.id <span class="op">=</span> <span class="va">group.id</span>,
                               group.id.level <span class="op">=</span> <span class="va">group.id.level</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">limma.fit.uhdata</span><span class="op">$</span><span class="va">P.Value</span> <span class="op">&lt;</span> <span class="fl">0.01</span>, dnn <span class="op">=</span> <span class="st">"DE genes"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">limma.fit.uhdata</span><span class="op">$</span><span class="va">P.Value</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DEA"</span>, <span class="st">"Count"</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tab</span>, rownames <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">DEA</th>
<th align="right">Count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FALSE</td>
<td align="right">159</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="right">16</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="biological-signal-reduction">Biological signal reduction<a class="anchor" aria-label="anchor" href="#biological-signal-reduction"></a>
</h4>
<p>It may be necessary to manipulate the level of the biological signal (i.e., the mean group difference between sample group) in a molecular classification study. To manipulate the level of the signal, <code><a href="../reference/reduce.signal.html">reduce.signal()</a></code> can be used.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># reduced signal by half</span>
<span class="va">group.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>
<span class="va">redhalf.biological.effect.nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduce.signal.html">reduce.signal</a></span><span class="op">(</span>biological.effect <span class="op">=</span> <span class="va">biological.effect.nc</span>,
                            group.id <span class="op">=</span> <span class="va">group.id</span>,
                            group.id.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"V"</span><span class="op">)</span>,
                            reduce.multiplier <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>


<span class="co"># extract differential expressed genes</span>
<span class="va">biological.effect.nc.psl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/med.sum.pbset.html">med.sum.pbset</a></span><span class="op">(</span><span class="va">biological.effect.nc</span><span class="op">)</span>
<span class="va">s.e.limma.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/limma.pbset.html">limma.pbset</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">biological.effect.nc.psl</span>,
                         group.id <span class="op">=</span> <span class="va">group.id</span>,
                         group.id.level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"V"</span><span class="op">)</span><span class="op">)</span>
<span class="va">de.ind</span> <span class="op">&lt;-</span> <span class="va">s.e.limma.fit</span><span class="op">$</span><span class="va">P.Value</span> <span class="op">&lt;</span> <span class="fl">0.01</span>

<span class="va">de.gene.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">redhalf.biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">de.ind</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="va">nonde.gene.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">redhalf.biological.effect.nc</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">de.ind</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>

<span class="va">biological.effect.nc.de</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span><span class="va">de.gene.name</span>, <span class="op">]</span>
<span class="va">redhalf.biological.effect.nc.de</span> <span class="op">&lt;-</span> <span class="va">redhalf.biological.effect.nc</span><span class="op">[</span><span class="va">de.gene.name</span>, <span class="op">]</span>

<span class="va">biological.effect.nc.nonde</span> <span class="op">&lt;-</span> <span class="va">biological.effect.nc</span><span class="op">[</span><span class="va">nonde.gene.name</span>, <span class="op">]</span>
<span class="va">redhalf.biological.effect.nc.nonde</span> <span class="op">&lt;-</span> <span class="va">redhalf.biological.effect.nc</span><span class="op">[</span><span class="va">nonde.gene.name</span>, <span class="op">]</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/reduce.signal.fig-1.png" width="384"></p>
</div>
<div class="section level4">
<h4 id="handling-effect-amplification">Handling effect amplification<a class="anchor" aria-label="anchor" href="#handling-effect-amplification"></a>
</h4>
<p>Again, it may be necessary to manipulate the confounding level of handling effects in the simulation study in order to evaluate normalization or classification methods in the presence of handling effect. We offer three amplification methods in <code><a href="../reference/amplify.handling.effect.html">amplify.handling.effect()</a></code>:</p>
<ol style="list-style-type: decimal">
<li><p>location shift - per selected array, shifting all probe expressions up or down by a constant.</p></li>
<li><p>scale change 1 - per selected array, expanding the variance of probes towards the array’s inter-quartiles; probes that are outside of inter-quartiles remain unchanged.</p></li>
<li><p>scale change 2 - scaling all probe expressions in arrays by the power of constants that are different for each batch. In our training data, there are four batches.</p></li>
<li><p>multiply - per selected array, multiply all probe expressions by a constant.</p></li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">handling.effect.nc.tr</span> <span class="op">&lt;-</span> <span class="va">handling.effect.nc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, <span class="fl">129</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span><span class="op">]</span>

<span class="co"># location shift</span>
<span class="va">handling.effect.nc.tr.shift</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amplify.handling.effect.html">amplify.handling.effect</a></span><span class="op">(</span>handling.effect <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
       amplify.array.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span><span class="op">]</span>,
       amplify.level <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"shift"</span><span class="op">)</span>
<span class="co"># multiply</span>
<span class="va">handling.effect.nc.tr.multiply</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amplify.handling.effect.html">amplify.handling.effect</a></span><span class="op">(</span>handling.effect <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
       amplify.array.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span><span class="op">]</span>,
       amplify.level <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"multiply"</span><span class="op">)</span>
<span class="co"># scale change 1</span>
<span class="va">handling.effect.nc.tr.scale1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amplify.handling.effect.html">amplify.handling.effect</a></span><span class="op">(</span>handling.effect <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
       amplify.array.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span><span class="op">]</span>,
       amplify.level <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"scale1"</span><span class="op">)</span>

<span class="co"># scale change 2</span>
<span class="va">amplify.array.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">41</span><span class="op">:</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">129</span><span class="op">:</span><span class="fl">160</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span>, <span class="op">(</span><span class="fl">161</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">amplify.array.id</span><span class="op">)</span><span class="op">)</span> 
  <span class="va">amplify.array.id</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr</span><span class="op">)</span><span class="op">[</span><span class="va">amplify.array.id</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>
<span class="va">amplify.level</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>

<span class="va">handling.effect.nc.tr.scale2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amplify.handling.effect.html">amplify.handling.effect</a></span><span class="op">(</span>handling.effect <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
       amplify.array.id <span class="op">=</span> <span class="va">amplify.array.id</span>,
       amplify.level <span class="op">=</span> <span class="va">amplify.level</span>,
       type <span class="op">=</span> <span class="st">"scale2"</span><span class="op">)</span>

<span class="co">#par(mfrow = c(2, 2), mar = c(2, 2, 2, 1))</span>
<span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr</span>, <span class="va">handling.effect.nc.tr.shift</span>, <span class="va">handling.effect.nc.tr.multiply</span>,
             <span class="va">handling.effect.nc.tr.scale1</span>, <span class="va">handling.effect.nc.tr.scale2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr</span>, main <span class="op">=</span> <span class="st">"Original"</span>,
        ylim <span class="op">=</span> <span class="va">rng</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.2</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/amplify.handling.effect-1.png" width="672"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr.shift</span>, main <span class="op">=</span> <span class="st">"Shift"</span>,
        ylim <span class="op">=</span> <span class="va">rng</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.2</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/amplify.handling.effect-2.png" width="672"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr.multiply</span>, main <span class="op">=</span> <span class="st">"multiply"</span>,
        ylim <span class="op">=</span> <span class="va">rng</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.2</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/amplify.handling.effect-3.png" width="672"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr.scale1</span>, main <span class="op">=</span> <span class="st">"Scaling 1"</span>,
        ylim <span class="op">=</span> <span class="va">rng</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.2</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/amplify.handling.effect-4.png" width="672"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">handling.effect.nc.tr.scale2</span>, main <span class="op">=</span> <span class="st">"Scaling 2"</span>,
        ylim <span class="op">=</span> <span class="va">rng</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.2</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/amplify.handling.effect-5.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="different-study-design-methods-and-normalization-methods-on-training-and-test-sets">Different Study Design Methods and Normalization Methods on Training and Test Sets<a class="anchor" aria-label="anchor" href="#different-study-design-methods-and-normalization-methods-on-training-and-test-sets"></a>
</h2>
<p>Furthermore, we care about the cooperative effects of different study design methods and normalization methods, separately on training and test sets. The function <code><a href="../reference/precision.simulate.class.html">precision.simulate.class()</a></code>, which is built upon the <code><a href="../reference/precision.simulate.html">precision.simulate()</a></code> , can apply different study design methods and normalization methods on training set and test set, and then fit more kinds of classifiers on the training set and predict them on test set.</p>
<p>The built-in designs are “NONE”, CC+“,”CC-“,”PC+“,”PC-“,”BLK“, and”STR" for “No Rehybridization”, “Complete Confounding 1”, “Complete Confounding 2”, “Partial Confounding 1”, “Partial Confounding 2”, “Blocking”, and “Stratification” in Qin et al.</p>
<ul>
<li><p>Study design methods on training set: {“NONE”, “CC+”, “CC-”, “PC+”, “PC-”, “BLK”, “STR”};</p></li>
<li><p>Study design methods on test set: {“NONE”, “CC+”, “CC-”, “PC+”, “PC-”, “BLK”, “STR”};</p></li>
</ul>
<p>The build-in available normalization methods are “NN”, “MN”, “QN”, “fMN”, “fQN”, “pMN”, “pQN”, “fVSN”, for “No Normalization”, “Median Normalization”, “Quantile Normalization”, “Frozen Median Normalization”, “Frozen Quantile Normalization”, “Pool Median Normalization”, “Pool Quantile Normalization”, “Frozen Variance Stability Normalization”.</p>
<ul>
<li><p>Normalization methods on training set: {“NN”, “MN”, “QN”, “VSN”};</p></li>
<li><p>Normalization methods on test set: {“NN”, “MN”, “QN”, “fMN”, “fQN”, “pMN”, “pQN”, “VSN”, “fVSN”}</p></li>
</ul>
<p>The build-in available classification methods are “PAM”, “LASSO”, “ClaNC”, “ranFor”, “SVM”, “kNN” and “DLDA”, for “Prediction Analysis for Microarrays”, “Least Absolute Shrinkage and Selection Operator”, “Classification to Nearest Centroids”, “Random Forest”, “Support Vector Machine”, “K-Nearest Neighbors” and “Diagonal Linear Discriminant”. You can also use your own classification method by setting  as “custom”. The format to create <code>custom.intcv</code> and <code>custom.predict</code> please refers to other classification methods in this package.</p>
<ul>
<li>Classifiers: {“PAM”, “LASSO”, “ClaNC”, “ranFor”, “SVM”, “kNN”, “DLDA”, “custom”}</li>
</ul>
<p>Choose the objective methods and express them in <code>train.design.met</code>, <code>test.design.met</code>, <code>train.norm.met</code>, <code>test.norm.met</code> and <code>class.met</code>. The output structure of one set of methods is similar to aforementioned <code><a href="../reference/precision.simulate.html">precision.simulate()</a></code>， with one more list called <code>ari_store</code>, which contains the adjusted rand index on test set.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">precision.class.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/precision.simulate.class.html">precision.simulate.class</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">0</span>, N <span class="op">=</span> <span class="fl">3</span>,
                          biological.effect.tr <span class="op">=</span> <span class="va">biological.effect.nc.tr</span>,    
                          biological.effect.te <span class="op">=</span> <span class="va">biological.effect.nc.te</span>,
                          handling.effect.tr <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
                          handling.effect.te <span class="op">=</span> <span class="va">handling.effect.nc.te</span>,
                          group.id.tr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.tr</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                          group.id.te <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.te</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                          train.design.met <span class="op">=</span> <span class="st">"PC+"</span>,
                          test.design.met <span class="op">=</span> <span class="st">"STR"</span>,
                          train.norm.met <span class="op">=</span> <span class="st">"QN"</span>,
                          test.norm.met <span class="op">=</span> <span class="st">"fQN"</span>,
                          class.met <span class="op">=</span> <span class="st">"ClaNC"</span>,
                          train.batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">41</span><span class="op">:</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">129</span><span class="op">:</span><span class="fl">160</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span>, <span class="op">(</span><span class="fl">161</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span><span class="op">)</span>,
                          test.batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">32</span>, <span class="fl">33</span><span class="op">:</span><span class="fl">64</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>precision.simulate.class sample error output</caption>
<thead><tr class="header">
<th align="right">internal</th>
<th align="right">external</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.1640625</td>
<td align="right">0.296875</td>
</tr>
<tr class="even">
<td align="right">0.1015625</td>
<td align="right">0.203125</td>
</tr>
<tr class="odd">
<td align="right">0.1250000</td>
<td align="right">0.234375</td>
</tr>
</tbody>
</table>
<p>To save time on calculation, there is an additional function called <code><a href="../reference/precision.simulate.multiclass.html">precision.simulate.multiclass()</a></code>. It replaces the <code>class.met</code>, which can only input one classification, with <code>class.list</code>, which can calculate several different classifications under the same combination of study design methods and normalization methods.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">precision.multiclass.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/precision.simulate.multiclass.html">precision.simulate.multiclass</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">0</span>, N <span class="op">=</span> <span class="fl">3</span>,
                          biological.effect.tr <span class="op">=</span> <span class="va">biological.effect.nc.tr</span>,    
                          biological.effect.te <span class="op">=</span> <span class="va">biological.effect.nc.te</span>,
                          handling.effect.tr <span class="op">=</span> <span class="va">handling.effect.nc.tr</span>,
                          handling.effect.te <span class="op">=</span> <span class="va">handling.effect.nc.te</span>,
                          group.id.tr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.tr</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                          group.id.te <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">biological.effect.nc.te</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,
                          train.design.met <span class="op">=</span> <span class="st">"PC+"</span>,
                          test.design.met <span class="op">=</span> <span class="st">"STR"</span>,
                          train.norm.met <span class="op">=</span> <span class="st">"QN"</span>,
                          test.norm.met <span class="op">=</span> <span class="st">"fQN"</span>,
                          class.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SVM"</span>, <span class="st">"kNN"</span>, <span class="st">"ClaNC"</span><span class="op">)</span>,
                          train.batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>, <span class="fl">41</span><span class="op">:</span><span class="fl">64</span>, <span class="op">(</span><span class="fl">129</span><span class="op">:</span><span class="fl">160</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span>, <span class="op">(</span><span class="fl">161</span><span class="op">:</span><span class="fl">192</span><span class="op">)</span> <span class="op">-</span> <span class="fl">64</span><span class="op">)</span>,
                          test.batch.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">32</span>, <span class="fl">33</span><span class="op">:</span><span class="fl">64</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>precision.simulate.multiclass sample error output</caption>
<colgroup>
<col width="15%">
<col width="15%">
<col width="15%">
<col width="15%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="right">SVM.internal</th>
<th align="right">SVM.external</th>
<th align="right">kNN.internal</th>
<th align="right">kNN.external</th>
<th align="right">ClaNC.internal</th>
<th align="right">ClaNC.external</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.1335385</td>
<td align="right">0.203125</td>
<td align="right">0.1194872</td>
<td align="right">0.187500</td>
<td align="right">0.1640625</td>
<td align="right">0.296875</td>
</tr>
<tr class="even">
<td align="right">0.2578462</td>
<td align="right">0.234375</td>
<td align="right">0.1379487</td>
<td align="right">0.156250</td>
<td align="right">0.1015625</td>
<td align="right">0.203125</td>
</tr>
<tr class="odd">
<td align="right">0.1636923</td>
<td align="right">0.218750</td>
<td align="right">0.1092308</td>
<td align="right">0.140625</td>
<td align="right">0.1250000</td>
<td align="right">0.234375</td>
</tr>
</tbody>
</table>
<p>You can use <code><a href="../reference/plot.precision.multiclass.html">plot.precision.multiclass()</a></code> to plot the average external error rates from the output of <code><a href="../reference/precision.simulate.multiclass.html">precision.simulate.multiclass()</a></code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.precision.multiclass.html">plot.precision.multiclass</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">precision.multiclass.results</span>,
                          mytitle <span class="op">=</span> <span class="st">"Average external error rates"</span>,
                          class.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SVM"</span>, <span class="st">"kNN"</span>, <span class="st">"ClaNC"</span><span class="op">)</span>,
                          ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>,
                          save.name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/error%20plot-1.png" width="480" style="display: block; margin: auto;"></p>
<!-- ### Calculate confounding level between handling effects and sample groups -->
<!-- We used a measurement to quantify confounding level between handling effects and sample group of interest[^8]. We used this measurement to cross-check our results based on confounding and balanced study designs. -->
<!-- [^8]: Leek JT, Scharpf RB, Bravo HC, Simcha D, Langmead B, Johnson WE, Geman D, Baggerly K, Irizarry RA: Tackling the widespread and critical impact of batch effects in high-throughput data. Nature reviews Genetics 2010, 11(10):733-739. -->
<!-- ```{r calc.confounding.level, comment = ">", message = FALSE, eval = FALSE} -->
<!-- # calculate confounding level  -->
<!-- nbe.genes <- ifelse(gene.cat == -1, TRUE, FALSE) -->
<!-- calc.confounding.level(data = biological.effect.nc[, biological.effect.train.ind],  -->
<!--                        group.id = substr(biological.effect.train.ind, 7, 7),  -->
<!--                        nbe.genes = nbe.genes) -->
<!-- ``` -->
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Huei-Chung Huang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
